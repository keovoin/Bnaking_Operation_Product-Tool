<!-- ... (previous unchanged HTML) ... -->
<!-- CMS Tab -->
<div class="tab-pane fade" id="upload" role="tabpanel" aria-labelledby="upload-tab">
    <div class="row">
        <div class="col-md-12">
            <div class="card my-3">
                <div class="card-header">Product Data Management (CMS)</div>
                <div class="card-body" id="cmsAuthSection">
                    <div id="cmsLoginForm">
                        <h5 class="section-title">Login Required</h5>
                        <p>Only authorized user can access this section.</p>
                        <div class="mb-3">
                            <label for="cmsUsername" class="form-label">Username</label>
                            <input type="text" class="form-control" id="cmsUsername" placeholder="Username">
                        </div>
                        <div class="mb-3">
                            <label for="cmsPassword" class="form-label">Password</label>
                            <input type="password" class="form-control" id="cmsPassword" placeholder="Password">
                        </div>
                        <button class="btn btn-primary" id="cmsLoginBtn">Login</button>
                    </div>
                </div>
                <div class="card-body" id="cmsSection" style="display:none;">
                    <ul class="nav nav-pills mb-3" id="cmsTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="cms-individual-tab" data-bs-toggle="pill" data-bs-target="#cms-individual" type="button" role="tab">Individual</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="cms-corporate-tab" data-bs-toggle="pill" data-bs-target="#cms-corporate" type="button" role="tab">Corporate</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="cms-td-tab" data-bs-toggle="pill" data-bs-target="#cms-td" type="button" role="tab">Term Deposits</button>
                        </li>
                    </ul>
                    <div class="tab-content" id="cmsTabsContent">
                        <!-- Repeat for each type -->
                        <div class="tab-pane fade show active" id="cms-individual" role="tabpanel">
                            <button class="btn btn-success mb-2" onclick="showAddEditModal('individual')"><i class="fas fa-plus"></i> Add Product</button>
                            <button class="btn btn-secondary mb-2 ms-2" onclick="triggerBulkUpload('individual')"><i class="fas fa-file-upload"></i> Bulk Upload</button>
                            <button class="btn btn-outline-primary mb-2 ms-2" onclick="downloadTemplate('individual')"><i class="fas fa-download"></i> Download Template</button>
                            <div id="cms-individual-table"></div>
                        </div>
                        <div class="tab-pane fade" id="cms-corporate" role="tabpanel">
                            <button class="btn btn-success mb-2" onclick="showAddEditModal('corporate')"><i class="fas fa-plus"></i> Add Product</button>
                            <button class="btn btn-secondary mb-2 ms-2" onclick="triggerBulkUpload('corporate')"><i class="fas fa-file-upload"></i> Bulk Upload</button>
                            <button class="btn btn-outline-primary mb-2 ms-2" onclick="downloadTemplate('corporate')"><i class="fas fa-download"></i> Download Template</button>
                            <div id="cms-corporate-table"></div>
                        </div>
                        <div class="tab-pane fade" id="cms-td" role="tabpanel">
                            <button class="btn btn-success mb-2" onclick="showAddEditModal('td')"><i class="fas fa-plus"></i> Add Term Deposit</button>
                            <button class="btn btn-secondary mb-2 ms-2" onclick="triggerBulkUpload('td')"><i class="fas fa-file-upload"></i> Bulk Upload</button>
                            <button class="btn btn-outline-primary mb-2 ms-2" onclick="downloadTemplate('td')"><i class="fas fa-download"></i> Download Template</button>
                            <div id="cms-td-table"></div>
                        </div>
                    </div>
                    <input type="file" id="cmsBulkUploadInput" accept=".xlsx" class="d-none" onchange="handleBulkUpload(event)">
                </div>
            </div>
        </div>
    </div>
    <!-- Modal for add/edit -->
    <div class="modal fade" id="cmsAddEditModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <form id="cmsProductForm">
                    <div class="modal-header">
                        <h5 class="modal-title" id="cmsModalTitle">Add Product</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body" id="cmsFormFields">
                        <!-- Dynamic form fields here -->
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary">Save</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- ... (rest of the page) ... -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/exceljs@4.3.0/dist/exceljs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
<script>
const CMS_USER = "keovoin";
const CMS_PASSWORD = Wing@Admin123"; // Set a strong password in production

// Auth logic
document.getElementById('cmsLoginBtn').onclick = function() {
    const u = document.getElementById('cmsUsername').value.trim();
    const p = document.getElementById('cmsPassword').value;
    if (u === CMS_USER && p === CMS_PASSWORD) {
        document.getElementById('cmsAuthSection').style.display = "none";
        document.getElementById('cmsSection').style.display = "block";
        renderCmsTables();
    } else {
        alert("Unauthorized.");
    }
};

// Table rendering and CRUD
function renderCmsTables() {
    ['individual','corporate','td'].forEach(type=>{
        const tableDiv = document.getElementById(`cms-${type}-table`);
        const dataArr = productData[type];
        let html = '<table class="table table-bordered table-sm"><thead><tr><th>Name</th><th>Type</th><th>Segment</th><th>Actions</th></tr></thead><tbody>';
        dataArr.forEach((row,i)=>{
            html += `<tr>
                <td>${row.name || ''}</td>
                <td>${row.type || ''}</td>
                <td>${row.segment || ''}</td>
                <td>
                    <button class="btn btn-sm btn-warning me-1" onclick="showAddEditModal('${type}',${i})"><i class="fas fa-edit"></i></button>
                    <button class="btn btn-sm btn-danger" onclick="deleteCmsProduct('${type}',${i})"><i class="fas fa-trash"></i></button>
                </td>
            </tr>`;
        });
        html += '</tbody></table>';
        tableDiv.innerHTML = html;
    });
}

// Add/Edit modal
function showAddEditModal(type, idx=null) {
    const modal = new bootstrap.Modal(document.getElementById('cmsAddEditModal'));
    let product = idx != null ? {...productData[type][idx]} : {name:'',type:'',segment:''};
    let html = `
        <input type="hidden" id="cmsEditIdx" value="${idx!=null ? idx : ''}">
        <input type="hidden" id="cmsEditType" value="${type}">
        <div class="mb-3">
            <label class="form-label">Name</label><input class="form-control" id="cmsName" value="${product.name||''}" required>
        </div>
        <div class="mb-3">
            <label class="form-label">Type</label><input class="form-control" id="cmsType" value="${product.type||''}" required>
        </div>
        <div class="mb-3">
            <label class="form-label">Segment</label><input class="form-control" id="cmsSegment" value="${product.segment||''}" required>
        </div>
        <!-- You can add more fields as needed! -->
    `;
    document.getElementById('cmsFormFields').innerHTML = html;
    document.getElementById('cmsModalTitle').textContent = idx!=null ? 'Edit Product' : 'Add Product';
    document.getElementById('cmsProductForm').onsubmit = function(e){
        e.preventDefault();
        const name = document.getElementById('cmsName').value;
        const typeField = document.getElementById('cmsType').value;
        const segment = document.getElementById('cmsSegment').value;
        if(idx!=null){
            productData[type][idx] = {name, type: typeField, segment};
        }else{
            productData[type].push({name, type: typeField, segment});
        }
        renderCmsTables();
        modal.hide();
    };
    modal.show();
}

// Delete
function deleteCmsProduct(type, idx){
    if(confirm("Are you sure you want to delete this product?")){
        productData[type].splice(idx,1);
        renderCmsTables();
    }
}

// Bulk upload/download
function triggerBulkUpload(type){
    document.getElementById('cmsBulkUploadInput').setAttribute('data-type',type);
    document.getElementById('cmsBulkUploadInput').click();
}
function handleBulkUpload(e){
    const file = e.target.files[0];
    const type = e.target.getAttribute('data-type');
    if(!file) return;
    const reader = new FileReader();
    reader.onload = async function(evt){
        const workbook = new ExcelJS.Workbook();
        await workbook.xlsx.load(evt.target.result);
        const sheet = workbook.worksheets[0];
        const arr = [];
        sheet.eachRow({includeEmpty:false},(row, rowNum)=>{
            if(rowNum===1) return; // skip header
            arr.push({
                name: row.getCell(1).value || '',
                type: row.getCell(2).value || '',
                segment: row.getCell(3).value || ''
            });
        });
        productData[type] = arr;
        renderCmsTables();
        alert("Bulk upload successful!");
    };
    reader.readAsArrayBuffer(file);
    e.target.value = '';
}
// Download template (minimal for demo)
function downloadTemplate(type){
    const workbook = new ExcelJS.Workbook();
    const sheet = workbook.addWorksheet('Template');
    sheet.addRow(['name','type','segment']);
    for(const p of productData[type]) {
        sheet.addRow([p.name,p.type,p.segment]);
    }
    workbook.xlsx.writeBuffer().then(buf=>{
        saveAs(new Blob([buf]), `template_${type}.xlsx`);
    });
}
</script>
