<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Banking Product Information Portal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/exceljs@4.3.0/dist/exceljs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        :root {
            --primary-color: #1a4f8e;
            --secondary-color: #3498db;
            --accent-color: #f8f9fa;
            --text-color: #333;
            --border-color: #dee2e6;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7fa;
            color: var(--text-color);
            padding-top: 20px;
        }
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .nav-tabs {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .nav-tabs .nav-link {
            font-weight: 600;
            padding: 15px 20px;
            color: var(--text-color);
            border: none;
        }
        .nav-tabs .nav-link.active {
            background-color: var(--primary-color);
            color: white;
            border: none;
        }
        .search-container {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .search-box {
            position: relative;
        }
        .search-box input {
            padding-left: 40px;
            border-radius: 25px;
        }
        .search-box i {
            position: absolute;
            left: 15px;
            top: 12px;
            color: #6c757d;
        }
        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
            transition: transform 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        .card-header {
            background-color: var(--primary-color);
            color: white;
            border-radius: 10px 10px 0 0 !important;
            font-weight: 600;
        }
        .info-table {
            width: 100%;
            margin-bottom: 0;
        }
        .info-table th {
            width: 30%;
            background-color: var(--accent-color);
        }
        .tab-content {
            padding: 20px 0;
        }
        .product-list {
            max-height: 300px;
            overflow-y: auto;
        }
        .list-group-item {
            border-left: none;
            border-right: none;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .list-group-item:hover {
            background-color: var(--accent-color);
        }
        .highlight {
            background-color: #fff8e1;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .section-title {
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 8px;
            margin: 25px 0 15px;
            color: var(--primary-color);
        }
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            color: #6c757d;
            font-size: 0.9rem;
        }
        .upload-area {
            border: 2px dashed #ccc;
            border-radius: 10px;
            padding: 25px;
            text-align: center;
            margin: 20px 0;
            background-color: #f8f9fa;
            transition: all 0.3s;
        }
        .upload-area:hover {
            border-color: var(--secondary-color);
            background-color: #e8f4ff;
        }
        .upload-icon {
            font-size: 3rem;
            color: var(--secondary-color);
            margin-bottom: 15px;
        }
        .password-prompt {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        @media (max-width: 768px) {
            .info-table th {
                width: 40%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header text-center">
            <h1><i class="fas fa-landmark me-2"></i>Banking Product Information Portal</h1>
            <p class="lead">Access detailed information about all banking products</p>
        </div>
        <ul class="nav nav-tabs nav-justified" id="productTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="individual-tab" data-bs-toggle="tab" data-bs-target="#individual" type="button" role="tab" aria-controls="individual" aria-selected="true">
                    <i class="fas fa-user me-2"></i>Individual Products
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="corporate-tab" data-bs-toggle="tab" data-bs-target="#corporate" type="button" role="tab" aria-controls="corporate" aria-selected="false">
                    <i class="fas fa-building me-2"></i>Corporate Products
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="td-tab" data-bs-toggle="tab" data-bs-target="#td" type="button" role="tab" aria-controls="td" aria-selected="false">
                    <i class="fas fa-chart-line me-2"></i>Term Deposits
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="upload-tab" data-bs-toggle="tab" data-bs-target="#upload" type="button" role="tab" aria-controls="upload" aria-selected="false">
                    <i class="fas fa-file-upload me-2"></i>Update Data
                </button>
            </li>
        </ul>
        <div class="tab-content" id="productTabsContent">
            <!-- Individual Products Tab -->
            <div class="tab-pane fade show active" id="individual" role="tabpanel" aria-labelledby="individual-tab">
                <div class="search-container">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" id="individualSearch" class="form-control" placeholder="Search individual products...">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <select id="individualFilter" class="form-select">
                                <option value="">All Segments</option>
                                <option value="General Individual Customer">General Individual Customer</option>
                                <option value="Business Gold">Business Gold</option>
                                <option value="Personal Elite">Personal Elite</option>
                                <option value="Payroll">Payroll</option>
                                <option value="Personal Premier">Personal Premier</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">Individual Products</div>
                            <div class="product-list list-group list-group-flush" id="individualProductsList">
                                <!-- Products will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <div id="individualProductDetail">
                            <div class="card">
                                <div class="card-body text-center p-5">
                                    <i class="fas fa-search fa-3x mb-3 text-muted"></i>
                                    <h5>Select a product to view details</h5>
                                    <p class="text-muted">Choose a product from the list to see comprehensive information</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Corporate Products Tab -->
            <div class="tab-pane fade" id="corporate" role="tabpanel" aria-labelledby="corporate-tab">
                <div class="search-container">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" id="corporateSearch" class="form-control" placeholder="Search corporate products...">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <select id="corporateFilter" class="form-select">
                                <option value="">All Segments</option>
                                <option value="Corporate/Company">Corporate/Company</option>
                                <option value="Government">Government</option>
                                <option value="MFI">MFI</option>
                                <option value="Company/Business platinum">Company/Business platinum</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">Corporate Products</div>
                            <div class="product-list list-group list-group-flush" id="corporateProductsList">
                                <!-- Products will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <div id="corporateProductDetail">
                            <div class="card">
                                <div class="card-body text-center p-5">
                                    <i class="fas fa-search fa-3x mb-3 text-muted"></i>
                                    <h5>Select a product to view details</h5>
                                    <p class="text-muted">Choose a product from the list to see comprehensive information</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Term Deposits Tab -->
            <div class="tab-pane fade" id="td" role="tabpanel" aria-labelledby="td-tab">
                <div class="search-container">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" id="tdSearch" class="form-control" placeholder="Search term deposits...">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <select id="tdFilter" class="form-select">
                                <option value="">All Segments</option>
                                <option value="General Customer">General Customer</option>
                                <option value="MFI BILL PAY">MFI BILL PAY</option>
                                <option value="FI (TREASURY)">FI (TREASURY)</option>
                                <option value="Wing and RGC Staffs">Wing and RGC Staffs</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">Term Deposit Products</div>
                            <div class="product-list list-group list-group-flush" id="tdProductsList">
                                <!-- Products will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <div id="tdProductDetail">
                            <div class="card">
                                <div class="card-body text-center p-5">
                                    <i class="fas fa-search fa-3x mb-3 text-muted"></i>
                                    <h5>Select a product to view details</h5>
                                    <p class="text-muted">Choose a product from the list to see comprehensive information</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- CMS Tab -->
            <div class="tab-pane fade" id="upload" role="tabpanel" aria-labelledby="upload-tab">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card my-3">
                            <div class="card-header">Product Data Management (CMS)</div>
                            <div class="card-body" id="cmsAuthSection">
                                <div id="cmsLoginForm">
                                    <h5 class="section-title">Login Required</h5>
                                    <p>Only authorized user can access this section.</p>
                                    <div class="mb-3">
                                        <label for="cmsUsername" class="form-label">Username</label>
                                        <input type="text" class="form-control" id="cmsUsername" placeholder="Username">
                                    </div>
                                    <div class="mb-3">
                                        <label for="cmsPassword" class="form-label">Password</label>
                                        <input type="password" class="form-control" id="cmsPassword" placeholder="Password">
                                    </div>
                                    <button class="btn btn-primary" id="cmsLoginBtn">Login</button>
                                </div>
                            </div>
                            <div class="card-body" id="cmsSection" style="display:none;">
                                <ul class="nav nav-pills mb-3" id="cmsTabs" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="cms-individual-tab" data-bs-toggle="pill" data-bs-target="#cms-individual" type="button" role="tab">Individual</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="cms-corporate-tab" data-bs-toggle="pill" data-bs-target="#cms-corporate" type="button" role="tab">Corporate</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="cms-td-tab" data-bs-toggle="pill" data-bs-target="#cms-td" type="button" role="tab">Term Deposits</button>
                                    </li>
                                </ul>
                                <div class="tab-content" id="cmsTabsContent">
                                    <div class="tab-pane fade show active" id="cms-individual" role="tabpanel">
                                        <button class="btn btn-success mb-2" onclick="showAddEditModal('individual')"><i class="fas fa-plus"></i> Add Product</button>
                                        <button class="btn btn-secondary mb-2 ms-2" onclick="triggerBulkUpload('individual')"><i class="fas fa-file-upload"></i> Bulk Upload</button>
                                        <button class="btn btn-outline-primary mb-2 ms-2" onclick="downloadTemplate('individual')"><i class="fas fa-download"></i> Download Template</button>
                                        <div id="cms-individual-table"></div>
                                    </div>
                                    <div class="tab-pane fade" id="cms-corporate" role="tabpanel">
                                        <button class="btn btn-success mb-2" onclick="showAddEditModal('corporate')"><i class="fas fa-plus"></i> Add Product</button>
                                        <button class="btn btn-secondary mb-2 ms-2" onclick="triggerBulkUpload('corporate')"><i class="fas fa-file-upload"></i> Bulk Upload</button>
                                        <button class="btn btn-outline-primary mb-2 ms-2" onclick="downloadTemplate('corporate')"><i class="fas fa-download"></i> Download Template</button>
                                        <div id="cms-corporate-table"></div>
                                    </div>
                                    <div class="tab-pane fade" id="cms-td" role="tabpanel">
                                        <button class="btn btn-success mb-2" onclick="showAddEditModal('td')"><i class="fas fa-plus"></i> Add Term Deposit</button>
                                        <button class="btn btn-secondary mb-2 ms-2" onclick="triggerBulkUpload('td')"><i class="fas fa-file-upload"></i> Bulk Upload</button>
                                        <button class="btn btn-outline-primary mb-2 ms-2" onclick="downloadTemplate('td')"><i class="fas fa-download"></i> Download Template</button>
                                        <div id="cms-td-table"></div>
                                    </div>
                                </div>
                                <input type="file" id="cmsBulkUploadInput" accept=".xlsx" class="d-none" onchange="handleBulkUpload(event)">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal fade" id="cmsAddEditModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <form id="cmsProductForm">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="cmsModalTitle">Add Product</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body" id="cmsFormFields">
                                    <!-- Dynamic form fields here -->
                                </div>
                                <div class="modal-footer">
                                    <button type="submit" class="btn btn-primary">Save</button>
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <footer>
            <p>Banking Product Information Portal &copy; 2023 | Designed for SharePoint Integration</p>
        </footer>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/exceljs@4.3.0/dist/exceljs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script>
    // Sample product data for demo purposes
    let productData = {
        individual: [
            {name:"Saving Account-Migrant Worker Digital KCY",type:"Saving",segment:"General Individual Customer"},
            {name:"Saving Account-Digital Wac Light",type:"Saving",segment:"General Individual Customer"},
            {name:"Saving Account-HIGH YIELD SAVING BUSINESS GOLD-GrowHigh",type:"Saving",segment:"General Individual Customer/Business Gold"}
        ],
        corporate: [
            {name:"Current Account - Corporate",type:"Current",segment:"Corporate/Company"}
        ],
        td: [
            {name:"Term Deposit",type:"TD",segment:"General Customer, VIP, Payroll, Government, SME, Corporate"},
            {name:"Term Deposit - MFI BILL PAY TERM DEPOSIT",type:"TD",segment:"MFI BILL PAY"},
            {name:"Term Deposit - FI (TREASURY) TERM DEPOSIT",type:"TD",segment:"FI (TREASURY)"},
            {name:"Term Deposit - WING & RGC STAFFS",type:"TD",segment:"All Wing and All RGC Staffs"}
        ]
    };

    // Tabs: Individual/Corporate/TD display logic
    function populateProductList(type, products) {
        const listElement = document.getElementById(`${type}ProductsList`);
        listElement.innerHTML = '';
        if (products.length === 0) {
            listElement.innerHTML = '<div class="list-group-item text-muted">No products found</div>';
            return;
        }
        products.forEach(product => {
            const item = document.createElement('button');
            item.type = 'button';
            item.className = 'list-group-item list-group-item-action';
            item.textContent = product.name;
            item.addEventListener('click', () => showProductDetails(type, product));
            listElement.appendChild(item);
        });
    }
    function setupSearch(type) {
        const searchInput = document.getElementById(`${type}Search`);
        searchInput.addEventListener('input', () => filterProducts(type));
    }
    function setupFilter(type) {
        const filterSelect = document.getElementById(`${type}Filter`);
        filterSelect.addEventListener('change', () => filterProducts(type));
    }
    function filterProducts(type) {
        const searchText = document.getElementById(`${type}Search`).value.toLowerCase();
        const filterValue = document.getElementById(`${type}Filter`).value;
        const products = productData[type];
        const filteredProducts = products.filter(product => {
            const matchesSearch = product.name.toLowerCase().includes(searchText);
            const matchesFilter = filterValue === '' || product.segment.includes(filterValue);
            return matchesSearch && matchesFilter;
        });
        populateProductList(type, filteredProducts);
        if (filteredProducts.length === 0) {
            document.getElementById(`${type}ProductDetail`).innerHTML = `
                <div class="card">
                    <div class="card-body text-center p-5">
                        <i class="fas fa-exclamation-circle fa-3x mb-3 text-muted"></i>
                        <h5>No products found</h5>
                        <p class="text-muted">Try adjusting your search or filter criteria</p>
                    </div>
                </div>
            `;
        }
    }
    function showProductDetails(type, product) {
        const detailElement = document.getElementById(`${type}ProductDetail`);
        // Simplified for demo; Add more detail fields as needed
        detailElement.innerHTML = `
            <div class="card">
                <div class="card-header">${product.name}</div>
                <div class="card-body">
                    <h5 class="section-title">Product Information</h5>
                    <table class="table info-table table-striped">
                        <tr><th>Product Type</th><td>${product.type}</td></tr>
                        <tr><th>Segment</th><td>${product.segment}</td></tr>
                    </table>
                </div>
            </div>
        `;
    }
    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
        populateProductList('individual', productData.individual);
        populateProductList('corporate', productData.corporate);
        populateProductList('td', productData.td);
        setupSearch('individual');
        setupSearch('corporate');
        setupSearch('td');
        setupFilter('individual');
        setupFilter('corporate');
        setupFilter('td');
    });

    // ========== CMS CODE ==========

    const CMS_USER = "keovoin";
    const CMS_PASSWORD = "Wing@Admin123"; // Set a strong password in production

    // Auth logic
    document.getElementById('cmsLoginBtn').onclick = function() {
        const u = document.getElementById('cmsUsername').value.trim();
        const p = document.getElementById('cmsPassword').value;
        if (u === CMS_USER && p === CMS_PASSWORD) {
            document.getElementById('cmsAuthSection').style.display = "none";
            document.getElementById('cmsSection').style.display = "block";
            renderCmsTables();
        } else {
            alert("Unauthorized.");
        }
    };

    // Table rendering and CRUD
    function renderCmsTables() {
        ['individual','corporate','td'].forEach(type=>{
            const tableDiv = document.getElementById(`cms-${type}-table`);
            const dataArr = productData[type];
            let html = '<table class="table table-bordered table-sm"><thead><tr><th>Name</th><th>Type</th><th>Segment</th><th>Actions</th></tr></thead><tbody>';
            dataArr.forEach((row,i)=>{
                html += `<tr>
                    <td>${row.name || ''}</td>
                    <td>${row.type || ''}</td>
                    <td>${row.segment || ''}</td>
                    <td>
                        <button class="btn btn-sm btn-warning me-1" onclick="showAddEditModal('${type}',${i})"><i class="fas fa-edit"></i></button>
                        <button class="btn btn-sm btn-danger" onclick="deleteCmsProduct('${type}',${i})"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>`;
            });
            html += '</tbody></table>';
            tableDiv.innerHTML = html;
        });
    }

    // Add/Edit modal
    function showAddEditModal(type, idx=null) {
        const modal = new bootstrap.Modal(document.getElementById('cmsAddEditModal'));
        let product = idx != null ? {...productData[type][idx]} : {name:'',type:'',segment:''};
        let html = `
            <input type="hidden" id="cmsEditIdx" value="${idx!=null ? idx : ''}">
            <input type="hidden" id="cmsEditType" value="${type}">
            <div class="mb-3">
                <label class="form-label">Name</label><input class="form-control" id="cmsName" value="${product.name||''}" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Type</label><input class="form-control" id="cmsType" value="${product.type||''}" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Segment</label><input class="form-control" id="cmsSegment" value="${product.segment||''}" required>
            </div>
            <!-- You can add more fields as needed! -->
        `;
        document.getElementById('cmsFormFields').innerHTML = html;
        document.getElementById('cmsModalTitle').textContent = idx!=null ? 'Edit Product' : 'Add Product';
        document.getElementById('cmsProductForm').onsubmit = function(e){
            e.preventDefault();
            const name = document.getElementById('cmsName').value;
            const typeField = document.getElementById('cmsType').value;
            const segment = document.getElementById('cmsSegment').value;
            if(idx!=null){
                productData[type][idx] = {name, type: typeField, segment};
            }else{
                productData[type].push({name, type: typeField, segment});
            }
            renderCmsTables();
            modal.hide();
        };
        modal.show();
    }

    // Delete
    function deleteCmsProduct(type, idx){
        if(confirm("Are you sure you want to delete this product?")){
            productData[type].splice(idx,1);
            renderCmsTables();
        }
    }

    // Bulk upload/download
    function triggerBulkUpload(type){
        document.getElementById('cmsBulkUploadInput').setAttribute('data-type',type);
        document.getElementById('cmsBulkUploadInput').click();
    }
    function handleBulkUpload(e){
        const file = e.target.files[0];
        const type = e.target.getAttribute('data-type');
        if(!file) return;
        const reader = new FileReader();
        reader.onload = async function(evt){
            const workbook = new ExcelJS.Workbook();
            await workbook.xlsx.load(evt.target.result);
            const sheet = workbook.worksheets[0];
            const arr = [];
            sheet.eachRow({includeEmpty:false},(row, rowNum)=>{
                if(rowNum===1) return; // skip header
                arr.push({
                    name: row.getCell(1).value || '',
                    type: row.getCell(2).value || '',
                    segment: row.getCell(3).value || ''
                });
            });
            productData[type] = arr;
            renderCmsTables();
            alert("Bulk upload successful!");
        };
        reader.readAsArrayBuffer(file);
        e.target.value = '';
    }
    // Download template (minimal for demo)
    function downloadTemplate(type){
        const workbook = new ExcelJS.Workbook();
        const sheet = workbook.addWorksheet('Template');
        sheet.addRow(['name','type','segment']);
        for(const p of productData[type]) {
            sheet.addRow([p.name,p.type,p.segment]);
        }
        workbook.xlsx.writeBuffer().then(buf=>{
            saveAs(new Blob([buf]), `template_${type}.xlsx`);
        });
    }
    </script>
</body>
</html>
